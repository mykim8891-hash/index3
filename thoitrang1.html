<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FashionBrand | C·ª≠a h√†ng th·ªùi trang online</title>
  <meta name="description" content="Website b√°n qu·∫ßn √°o th·ªùi trang: danh m·ª•c, t√¨m ki·∫øm, l·ªçc, s·∫Øp x·∫øp, gi·ªè h√†ng, y√™u th√≠ch, thanh to√°n, m√£ gi·∫£m gi√°. Thu·∫ßn HTML/CSS/JS."/>
  <style>
    :root{
      --bg:#0f172a;         /* n·ªÅn t·ªëi sang tr·ªçng */
      --card:#111827;       /* n·ªÅn th·∫ª */
      --muted:#94a3b8;      /* ch·ªØ ph·ª• */
      --text:#e5e7eb;       /* ch·ªØ ch√≠nh */
      --brand:#22c55e;      /* xanh l√° hi·ªán ƒë·∫°i */
      --brand-2:#16a34a;    /* xanh ƒë·∫≠m */
      --accent:#38bdf8;     /* xanh nh·∫°t nh·∫•n */
      --danger:#ef4444;     /* ƒë·ªè l·ªói */
      --warning:#f59e0b;
      --ok:#10b981;
      --shadow:0 10px 25px rgba(0,0,0,.25);
      --radius:18px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:linear-gradient(180deg,#0b1224,#0f172a 30%,#0b1224);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}
    .container{width:min(1200px,95%);margin-inline:auto}
    .grid{display:grid;gap:16px}
    .btn{display:inline-flex;align-items:center;gap:8px;border:none;border-radius:999px;padding:10px 16px;background:var(--brand);color:#031;cursor:pointer;font-weight:600;box-shadow:var(--shadow);transition:.2s}
    .btn:hover{transform:translateY(-1px);background:var(--brand-2)}
    .btn.outline{background:#0000;border:1px solid #2dd4bf;color:#cffafe}
    .btn.ghost{background:#0000;color:var(--text);border:1px solid #334155}
    .pill{border-radius:999px;background:#0b132a;padding:6px 10px;border:1px solid #223152;color:#cbd5e1}
    .badge{border-radius:999px;background:#172554;padding:2px 8px;border:1px solid #1e3a8a;color:#c7d2fe;font-size:12px}
    .chip{border:1px solid #334155;border-radius:999px;padding:6px 10px;color:#cbd5e1;background:#0b1320;cursor:pointer}
    header{position:sticky;top:0;z-index:50;background:rgba(6,10,20,.7);backdrop-filter:blur(8px);border-bottom:1px solid #1f2937}
    .nav{display:flex;align-items:center;justify-content:space-between;padding:10px 0}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800}
    .brand .logo{width:36px;height:36px;border-radius:10px;background:conic-gradient(from 210deg,var(--brand),#67e8f9 40%,#60a5fa 70%,#22c55e);box-shadow:0 0 0 3px #0b1220}
    .actions{display:flex;align-items:center;gap:8px}
    .searchbar{flex:1;display:flex;align-items:center;gap:8px;background:#0b1320;border:1px solid #223152;border-radius:999px;padding:6px 10px;margin-inline:16px}
    .searchbar input{flex:1;background:transparent;border:none;color:var(--text);outline:none}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap}

    .hero{position:relative;margin-top:18px;border:1px solid #1f2937;border-radius:var(--radius);overflow:hidden;background:radial-gradient(1200px 400px at 80% -10%,rgba(34,197,94,.2),transparent 60%),linear-gradient(135deg,rgba(56,189,248,.12),rgba(34,197,94,.12));}
    .hero-inner{display:grid;grid-template-columns:1.1fr .9fr;gap:16px;align-items:center;padding:24px}
    .hero h1{font-size:clamp(24px,4vw,40px);line-height:1.05;margin:0}
    .hero p{color:var(--muted);margin:8px 0 16px}
    .card{background:linear-gradient(180deg,#0b1320,#0b1628);border:1px solid #1f2937;border-radius:16px;padding:12px;box-shadow:var(--shadow)}
    .price{font-weight:800}

    .sidebar{position:sticky;top:76px;align-self:start}
    .filters{display:grid;gap:10px}
    .range{accent-color:var(--brand);width:100%}

    .products{grid-template-columns:repeat(12,1fr)}
    .product{grid-column:span 3;background:linear-gradient(180deg,#0b1320,#0b1628);border:1px solid #1f2937;border-radius:16px;overflow:hidden;display:flex;flex-direction:column}
    .product .thumb{aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;background:radial-gradient(circle at 30% 20%,#123 0,#0a1221 60%)}
    .product .info{padding:12px;display:grid;gap:8px}
    .product .meta{display:flex;justify-content:space-between;align-items:center}
    .product .actions{display:flex;gap:8px}

    .section{margin:24px 0}
    .section h2{margin:0 0 12px;font-size:22px}

    /* Cart Drawer */
    .drawer{position:fixed;inset:0;display:none}
    .drawer.show{display:block}
    .drawer .overlay{position:absolute;inset:0;background:rgba(2,6,23,.6);backdrop-filter:blur(4px)}
    .drawer .panel{position:absolute;right:0;top:0;height:100%;width:min(560px,92%);background:#0b1320;border-left:1px solid #1f2937;display:flex;flex-direction:column}
    .drawer header{position:initial;background:transparent;border:0}
    .cart-items{padding:12px;display:grid;gap:12px;overflow:auto;max-height:50vh}
    .cart-summary{margin-top:auto;border-top:1px solid #1f2937;padding:12px;display:grid;gap:8px}
    .row{display:flex;justify-content:space-between;align-items:center}

    /* Modal */
    .modal{position:fixed;inset:0;display:none}
    .modal.show{display:block}
    .modal .overlay{position:absolute;inset:0;background:rgba(2,6,23,.7);backdrop-filter:blur(6px)}
    .modal .box{position:relative;width:min(920px,94%);margin:6vh auto;background:#0b1320;border:1px solid #1f2937;border-radius:16px;overflow:hidden}

    /* Checkout */
    form.checkout{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    form.checkout .field{display:grid}
    input,select,textarea{background:#0b1320;border:1px solid #223152;border-radius:12px;padding:10px;color:var(--text);outline:0}
    textarea{min-height:80px}

    footer{margin:40px 0 20px;color:#9aa3b1}
    .cols{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}

    /* Responsive */
    @media (max-width: 1024px){
      .product{grid-column:span 4}
      .hero-inner{grid-template-columns:1fr}
    }
    @media (max-width: 720px){
      .product{grid-column:span 6}
      .nav{gap:8px;flex-wrap:wrap}
      .searchbar{order:3;width:100%;margin:8px 0}
      form.checkout{grid-template-columns:1fr}
      .cols{grid-template-columns:1fr 1fr}
    }
    @media (max-width: 480px){
      .product{grid-column:span 12}
      .cols{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand"><div class="logo"></div><span>FashionBrand</span></div>
      <div class="searchbar">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 21l-4.35-4.35" stroke="#7dd3fc" stroke-width="2" stroke-linecap="round"/><circle cx="11" cy="11" r="7" stroke="#64748b" stroke-width="2"/></svg>
        <input id="q" placeholder="T√¨m s·∫£n ph·∫©m, ch·∫•t li·ªáu, b·ªô s∆∞u t·∫≠p..."/>
      </div>
      <div class="actions">
        <button class="btn ghost" id="openWishlist" title="Y√™u th√≠ch">‚ù§ <span class="badge" id="wishCount">0</span></button>
        <button class="btn" id="openCart" title="Gi·ªè h√†ng">üõí <span class="badge" id="cartCount">0</span></button>
      </div>
    </div>
  </header>

  <section class="container hero">
    <div class="hero-inner">
      <div>
        <h1>BST Thu & ƒê√¥ng 2025 ‚Äì <span class="badge">NEW</span></h1>
        <p>Ch·∫•t li·ªáu th√¢n thi·ªán m√¥i tr∆∞·ªùng, phom d√°ng t·ªëi ∆∞u cho v√≥c d√°ng ng∆∞·ªùi Vi·ªát. Mi·ªÖn ph√≠ ƒë·ªïi size trong 7 ng√†y, giao nhanh 2h n·ªôi th√†nh.</p>
        <div class="toolbar">
          <button class="btn" onclick="scrollToProducts()">Mua ngay</button>
          <button class="btn outline" onclick="document.getElementById('newsletter').scrollIntoView({behavior:'smooth'})">Nh·∫≠n ∆∞u ƒë√£i</button>
          <div class="pill">M√£ gi·∫£m gi√° h√¥m nay: <strong>SALE10</strong></div>
        </div>
      </div>
      <div class="card grid" style="grid-template-columns:1.2fr .8fr;align-items:center">
        <div>
          <img src="https://images.unsplash.com/photo-1592878904946-b3cd4f3b8908?q=80&w=1200&auto=format&fit=crop" alt="lookbook" style="border-radius:12px"/>
        </div>
        <div class="grid" style="gap:10px">
          <div class="card">
            <div class="row"><strong>Freeship</strong><span class="badge">ƒë∆°n t·ª´ 499K</span></div>
          </div>
          <div class="card">
            <div class="row"><strong>ƒê·ªïi tr·∫£</strong><span class="badge">trong 7 ng√†y</span></div>
          </div>
          <div class="card">
            <div class="row"><strong>B·∫£o h√†nh</strong><span class="badge">ƒë∆∞·ªùng may 90 ng√†y</span></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <main class="container section grid" style="grid-template-columns:260px 1fr">
    <!-- Sidebar Filters -->
    <aside class="sidebar">
      <div class="card">
        <h3 style="margin:6px 0 12px">B·ªô l·ªçc</h3>
        <div class="filters">
          <div>
            <small>Danh m·ª•c</small>
            <div id="catFilters" class="grid" style="grid-template-columns:repeat(2,1fr);gap:8px"></div>
          </div>
          <div>
            <small>Gi√° t·ªëi ƒëa: <span id="priceVal">1.000.000</span>ƒë</small>
            <input id="priceRange" type="range" min="99000" max="1000000" step="10000" class="range"/>
          </div>
          <div>
            <small>Size</small>
            <div id="sizeFilters" class="grid" style="grid-template-columns:repeat(4,1fr);gap:8px"></div>
          </div>
          <div>
            <small>Ch·∫•t li·ªáu</small>
            <div id="matFilters" class="grid" style="grid-template-columns:repeat(3,1fr);gap:8px"></div>
          </div>
          <div>
            <small>S·∫Øp x·∫øp</small>
            <select id="sortBy">
              <option value="popular">Ph·ªï bi·∫øn</option>
              <option value="priceAsc">Gi√° tƒÉng d·∫ßn</option>
              <option value="priceDesc">Gi√° gi·∫£m d·∫ßn</option>
              <option value="newest">M·ªõi nh·∫•t</option>
            </select>
          </div>
          <button class="btn ghost" id="clearFilters">X√≥a b·ªô l·ªçc</button>
        </div>
      </div>
      <div class="card" id="newsletter">
        <h3 style="margin:6px 0 12px">Nh·∫≠n tin & ∆∞u ƒë√£i</h3>
        <div class="grid" style="gap:8px">
          <input id="subEmail" placeholder="Email c·ªßa b·∫°n"/>
          <button class="btn" id="subBtn">ƒêƒÉng k√Ω</button>
          <small class="muted">M√£ -10% s·∫Ω g·ª≠i v√†o email sau khi x√°c nh·∫≠n.</small>
        </div>
      </div>
    </aside>

    <!-- Products -->
    <section style="display:grid;gap:12px">
      <div class="row" style="align-items:center">
        <h2 style="margin:0">S·∫£n ph·∫©m</h2>
        <div class="pill" id="resultCount">0 k·∫øt qu·∫£</div>
      </div>
      <div id="tags" class="row" style="gap:8px;flex-wrap:wrap"></div>
      <div id="productGrid" class="grid products"></div>
    </section>
  </main>

  <!-- Cart Drawer -->
  <div class="drawer" id="cartDrawer" aria-hidden="true">
    <div class="overlay" onclick="toggleCart()"></div>
    <div class="panel">
      <header class="container nav" style="padding:12px 16px">
        <strong>Gi·ªè h√†ng</strong>
        <button class="btn ghost" onclick="toggleCart()">ƒê√≥ng</button>
      </header>
      <div class="cart-items" id="cartItems"></div>
      <div class="cart-summary">
        <div class="grid" style="gap:8px">
          <div class="row"><span>T·ªïng t·∫°m t√≠nh</span><strong id="subTotal">0ƒë</strong></div>
          <div class="row"><span>V·∫≠n chuy·ªÉn</span><span id="shipping">0ƒë</span></div>
          <div class="row"><span>Gi·∫£m gi√°</span><span id="discount">0ƒë</span></div>
          <div class="row" style="border-top:1px solid #1f2937;padding-top:8px"><span>T·ªïng c·ªông</span><strong id="grandTotal">0ƒë</strong></div>
        </div>
        <div class="row" style="gap:8px">
          <input id="coupon" placeholder="Nh·∫≠p m√£ gi·∫£m gi√°" style="flex:1"/>
          <button class="btn" onclick="applyCoupon()">√Åp d·ª•ng</button>
        </div>
        <button class="btn" onclick="openCheckout()">Thanh to√°n</button>
      </div>
    </div>
  </div>

  <!-- Wishlist Modal -->
  <div class="modal" id="wishModal" aria-hidden="true">
    <div class="overlay" onclick="toggleWish()"></div>
    <div class="box">
      <div class="container" style="padding:16px 16px">
        <div class="row" style="align-items:center">
          <h3 style="margin:0">Y√™u th√≠ch</h3>
          <button class="btn ghost" onclick="toggleWish()">ƒê√≥ng</button>
        </div>
        <div id="wishItems" class="grid" style="grid-template-columns:repeat(3,1fr);gap:12px;margin-top:12px"></div>
      </div>
    </div>
  </div>

  <!-- Quick View Modal -->
  <div class="modal" id="quickModal" aria-hidden="true">
    <div class="overlay" onclick="toggleQuick()"></div>
    <div class="box">
      <div class="grid" style="grid-template-columns:1fr 1fr;gap:12px;padding:12px">
        <div id="quickImg" class="card" style="height:100%"></div>
        <div class="grid" style="gap:10px;padding:4px 12px 12px">
          <div class="row" style="gap:8px;align-items:center">
            <h3 id="quickName" style="margin:0"></h3>
            <span class="badge" id="quickCat"></span>
          </div>
          <div id="quickPrice" class="price"></div>
          <div id="quickDesc" style="color:var(--muted)"></div>
          <div>
            <small>Ch·ªçn size</small>
            <div id="quickSizes" class="row" style="gap:8px;flex-wrap:wrap"></div>
          </div>
          <div class="row" style="gap:8px">
            <button class="btn" id="quickAdd">Th√™m v√†o gi·ªè</button>
            <button class="btn ghost" id="quickWish">‚ù§ Y√™u th√≠ch</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Checkout Modal -->
  <div class="modal" id="checkoutModal" aria-hidden="true">
    <div class="overlay" onclick="toggleCheckout()"></div>
    <div class="box">
      <div style="padding:12px 16px;border-bottom:1px solid #1f2937" class="row">
        <h3 style="margin:0">Thanh to√°n</h3>
        <button class="btn ghost" onclick="toggleCheckout()">ƒê√≥ng</button>
      </div>
      <div class="container" style="padding:12px 16px 20px">
        <form class="checkout" id="checkoutForm">
          <div class="field"><label>H·ªç t√™n</label><input required name="name"/></div>
          <div class="field"><label>S·ªë ƒëi·ªán tho·∫°i</label><input required name="phone" pattern="[0-9]{9,11}"/></div>
          <div class="field"><label>Email</label><input required type="email" name="email"/></div>
          <div class="field"><label>T·ªânh/Th√†nh</label><input required name="city"/></div>
          <div class="field"><label>Qu·∫≠n/Huy·ªán</label><input required name="district"/></div>
          <div class="field"><label>ƒê·ªãa ch·ªâ</label><input required name="address"/></div>
          <div class="field" style="grid-column:1/-1"><label>Ghi ch√∫</label><textarea name="note" placeholder="V√≠ d·ª•: giao gi·ªù h√†nh ch√≠nh"></textarea></div>
          <div class="field"><label>Ph∆∞∆°ng th·ª©c</label>
            <select name="method">
              <option value="cod">Thanh to√°n khi nh·∫≠n h√†ng (COD)</option>
              <option value="bank">Chuy·ªÉn kho·∫£n ng√¢n h√†ng</option>
              <option value="visa">Th·∫ª Visa/Master</option>
            </select>
          </div>
          <div class="card" style="grid-column:1/-1">
            <div class="row"><strong>T√≥m t·∫Øt ƒë∆°n h√†ng</strong><span id="sumCount">0 s·∫£n ph·∫©m</span></div>
            <div id="sumList" class="grid" style="gap:6px;margin-top:8px"></div>
            <div class="row" style="border-top:1px solid #1f2937;margin-top:8px;padding-top:8px"><span>T·ªïng thanh to√°n</span><strong id="sumGrand">0ƒë</strong></div>
          </div>
          <button class="btn" style="grid-column:1/-1">X√°c nh·∫≠n ƒë·∫∑t h√†ng</button>
        </form>
      </div>
    </div>
  </div>

  <footer class="container">
    <div class="cols">
      <div>
        <div class="brand" style="margin-bottom:8px"><div class="logo"></div><span>FashionBrand</span></div>
        <small>¬© 2025 FashionBrand. S·∫£n ph·∫©m ch√≠nh h√£ng, ho√†n ti·ªÅn 200% n·∫øu ph√°t hi·ªán h√†ng gi·∫£.</small>
      </div>
      <div>
        <strong>D·ªãch v·ª•</strong>
        <ul>
          <li>Ch√≠nh s√°ch b·∫£o h√†nh</li>
          <li>Ch√≠nh s√°ch v·∫≠n chuy·ªÉn</li>
          <li>H∆∞·ªõng d·∫´n ch·ªçn size</li>
          <li>Ch∆∞∆°ng tr√¨nh th√†nh vi√™n</li>
        </ul>
      </div>
      <div>
        <strong>Th√¥ng tin</strong>
        <ul>
          <li>V·ªÅ ch√∫ng t√¥i</li>
          <li>Tuy·ªÉn d·ª•ng</li>
          <li>Li√™n h·ªá h·ª£p t√°c</li>
          <li>Blog th·ªùi trang</li>
        </ul>
      </div>
      <div>
        <strong>K·∫øt n·ªëi</strong>
        <div class="row" style="gap:8px"><span class="chip">Facebook</span><span class="chip">Instagram</span><span class="chip">TikTok</span></div>
      </div>
    </div>
  </footer>

  <script>
    // ====== MOCK DATA ======
    const PRODUCTS = [
      {id:'tee-basic', name:'√Åo thun Basic', price:159000, material:'Cotton', sizes:['S','M','L','XL'], category:'√Åo', rating:4.7, created:'2025-08-01', img:'https://city89.com/wp-content/uploads/2023/04/bs-0094-mockup-bkack-front.jpg', desc:'√Åo thun cotton 2 chi·ªÅu, th·∫•m h√∫t t·ªët, co gi√£n nh·∫π.'},
      {id:'tee-oversize', name:'√Åo thun Oversize', price:199000, material:'Cotton', sizes:['M','L','XL'], category:'√Åo', rating:4.8, created:'2025-08-10', img:'https://pos.nvncdn.com/05016d-25618/ps/20230718_2ixOyFxbNF.png?v=1689656178', desc:'Form r·ªông, v·∫£i d√†y d·∫∑n, trend 2025.'},
      {id:'shirt-linen', name:'S∆° mi Linen', price:329000, material:'Linen', sizes:['S','M','L'], category:'√Åo', rating:4.6, created:'2025-07-20', img:'https://bizweb.dktcdn.net/100/481/348/products/z4528556645151-906f267da8f9af81c3926ca7fc6f9050-1689817398218.jpg?v=1689817405417', desc:'M√°t m·∫ª, tho√°ng kh√≠, ph√π h·ª£p th·ªùi ti·∫øt n√≥ng ·∫©m.'},
      {id:'hoodie-fleece', name:'Hoodie Fleece', price:459000, material:'Fleece', sizes:['M','L','XL'], category:'√Åo', rating:4.9, created:'2025-07-05', img:'https://product.hstatic.net/200000259629/product/1__1__679ae6c8d9c44c0da1fbb4611a78cd1a_master.png', desc:'Gi·ªØ ·∫•m t·ªët, m≈© tr√πm m·ªÅm, t√∫i kangaroo ti·ªán l·ª£i.'},
      {id:'jean-slim', name:'Qu·∫ßn Jean Slim', price:399000, material:'Denim', sizes:['28','29','30','31','32'], category:'Qu·∫ßn', rating:4.7, created:'2025-07-28', img:'https://product.hstatic.net/200000887901/product/an-nam-aristino-slim-fit-ajn01103__3__3dca3f8d9cdb44af86af16ee84e54656_940d2836fbea4944bce8f22c8a6814a3.jpg', desc:'Slim fit, co gi√£n nh·∫π, t√¥n d√°ng.'},
      {id:'jean-relax', name:'Qu·∫ßn Jean Relax', price:429000, material:'Denim', sizes:['30','31','32','33'], category:'Qu·∫ßn', rating:4.5, created:'2025-06-20', img:'https://product.hstatic.net/200000886795/product/img_3163.1_e12f5f52bd8547e6989a04096c4f7bf5.jpg', desc:'·ªêng su√¥ng tho·∫£i m√°i, ch·∫•t denim d√†y d·∫∑n.'},
      {id:'pant-chino', name:'Qu·∫ßn Chino', price:349000, material:'Twill', sizes:['29','30','31','32','33'], category:'Qu·∫ßn', rating:4.4, created:'2025-08-12', img:'https://wiisnt.vn/_next/image/?url=https%3A%2F%2Fapi.wiisnt.vn%2Fmedia%2Fcatalog%2Fproduct%2Fcache%2F3bdbc7ac0c3fb016006263cafc028ace%2Fb%2Fe%2Fbeige_1__1.jpg&w=2048&q=75', desc:'Ch·∫•t li·ªáu twill m·ªÅm, l·ªãch s·ª±, ƒëi l√†m hay ƒëi ch∆°i ƒë·ªÅu h·ª£p.'},
      {id:'skirt-midi', name:'V√°y Midi', price:379000, material:'Chiffon', sizes:['S','M','L'], category:'V√°y', rating:4.6, created:'2025-07-15', img:'https://product.hstatic.net/200000642151/product/w-ts22s-008-blk___wo-sk23s-005-blk_060c269383a74d0293524763a7f169c7_master.jpg', desc:'D·ªãu d√†ng, bay b·ªïng, t√¥n d√°ng.'},
      {id:'dress-slip', name:'ƒê·∫ßm Slip', price:499000, material:'Satin', sizes:['S','M'], category:'V√°y', rating:4.8, created:'2025-08-14', img:'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR_HNVZRMqzD-1DFQ0F-O5OclwyLQhK2K0OmT1sM5dAhIZctOjMO7PtixGEzZupphzNGbk&usqp=CAU', desc:'Satin b√≥ng nh·∫π, sang tr·ªçng.'},
      {id:'set-sport', name:'Set ƒê·ªì Th·ªÉ Thao', price:289000, material:'Polyester', sizes:['S','M','L'], category:'ƒê·ªì b·ªô', rating:4.3, created:'2025-06-30', img:'https://bizweb.dktcdn.net/100/455/994/products/6l.jpg?v=1704855523467', desc:'Nhanh kh√¥, co gi√£n, tho·∫£i m√°i v·∫≠n ƒë·ªông.'},
      {id:'jacket-bomber', name:'√Åo Kho√°c Bomber', price:479000, material:'Nylon', sizes:['M','L','XL'], category:'√Åo kho√°c', rating:4.7, created:'2025-08-05', img:'https://product.hstatic.net/200000370449/product/39d5890d348eedd0b49f_56c4e697565743e6bab0e9b3ac51c9c8_master.jpg', desc:'Ch·ªëng gi√≥, form chu·∫©n, d·ªÖ ph·ªëi.'},
      {id:'jacket-denim', name:'√Åo Kho√°c Denim', price:539000, material:'Denim', sizes:['M','L'], category:'√Åo kho√°c', rating:4.9, created:'2025-07-25', img:'https://down-vn.img.susercontent.com/file/vn-11134207-7r98o-lxhzq7103eu338_tn', desc:'Denim wash ƒë·∫πp, b·ªÅn b·ªâ.'},
    ];

    const CATEGORIES = [...new Set(PRODUCTS.map(p=>p.category))];
    const SIZES = [...new Set(PRODUCTS.flatMap(p=>p.sizes))];
    const MATERIALS = [...new Set(PRODUCTS.map(p=>p.material))];

    // ====== STATE ======
    let state = {
      q:'',
      cats: new Set(),
      sizes: new Set(),
      mats: new Set(),
      maxPrice: 1000000,
      sort: 'popular',
      cart: JSON.parse(localStorage.getItem('cart')||'[]'),
      wish: new Set(JSON.parse(localStorage.getItem('wish')||'[]')),
      coupon: null,
      selectedSize: null,
    };

    // ====== HELPERS ======
    const VND = n => n.toLocaleString('vi-VN') + 'ƒë';
    const el = sel => document.querySelector(sel);
    const div = (cls,html='')=>{const d=document.createElement('div'); if(cls) d.className=cls; d.innerHTML=html; return d};

    function persist(){
      localStorage.setItem('cart', JSON.stringify(state.cart));
      localStorage.setItem('wish', JSON.stringify([...state.wish]));
    }

    function match(p){
      if(p.price>state.maxPrice) return false;
      const text = (p.name+' '+p.material+' '+p.category).toLowerCase();
      if(state.q && !text.includes(state.q.toLowerCase())) return false;
      if(state.cats.size && !state.cats.has(p.category)) return false;
      if(state.mats.size && !state.mats.has(p.material)) return false;
      if(state.sizes.size && !p.sizes.some(s=>state.sizes.has(s))) return false;
      return true;
    }

    function sortItems(list){
      switch(state.sort){
        case 'priceAsc': return list.sort((a,b)=>a.price-b.price);
        case 'priceDesc': return list.sort((a,b)=>b.price-a.price);
        case 'newest': return list.sort((a,b)=>new Date(b.created)-new Date(a.created));
        default: return list.sort((a,b)=>b.rating-a.rating);
      }
    }

    // ====== RENDER ======
    function renderFilters(){
      // Categories
      const catBox = el('#catFilters'); catBox.innerHTML='';
      CATEGORIES.forEach(c=>{
        const x = div('chip'+(state.cats.has(c)?' badge':''), c); x.onclick=()=>{state.cats.has(c)?state.cats.delete(c):state.cats.add(c); renderAll();}; catBox.appendChild(x);
      });
      // Sizes
      const sBox = el('#sizeFilters'); sBox.innerHTML='';
      SIZES.forEach(s=>{const x = div('chip'+(state.sizes.has(s)?' badge':''), s); x.onclick=()=>{state.sizes.has(s)?state.sizes.delete(s):state.sizes.add(s); renderAll();}; sBox.appendChild(x);});
      // Materials
      const mBox = el('#matFilters'); mBox.innerHTML='';
      MATERIALS.forEach(m=>{const x = div('chip'+(state.mats.has(m)?' badge':''), m); x.onclick=()=>{state.mats.has(m)?state.mats.delete(m):state.mats.add(m); renderAll();}; mBox.appendChild(x);});
      // Price
      el('#priceRange').value = state.maxPrice; el('#priceVal').textContent = state.maxPrice.toLocaleString('vi-VN');
      // Sort
      el('#sortBy').value = state.sort;
      // Tags
      const tags = el('#tags'); tags.innerHTML='';
      if(state.q) tags.appendChild(tag('T√¨m: '+state.q, ()=>{state.q=''; el('#q').value=''; renderAll();}));
      state.cats.forEach(v=>tags.appendChild(tag(v,()=>{state.cats.delete(v); renderAll();})));
      state.sizes.forEach(v=>tags.appendChild(tag('Size '+v,()=>{state.sizes.delete(v); renderAll();})));
      state.mats.forEach(v=>tags.appendChild(tag(v,()=>{state.mats.delete(v); renderAll();})));
      if(state.maxPrice<1000000) tags.appendChild(tag('‚â§ '+VND(state.maxPrice),()=>{state.maxPrice=1000000; renderAll();}));
    }

    function tag(text, onClose){
      const t = div('pill', `<span>${text}</span> <button class="btn ghost" style="padding:2px 8px">x</button>`);
      t.querySelector('button').onclick = onClose; return t;
    }

    function renderProducts(){
      const grid = el('#productGrid'); grid.innerHTML='';
      const items = sortItems(PRODUCTS.filter(match));
      el('#resultCount').textContent = items.length + ' k·∫øt qu·∫£';
      items.forEach(p=>{
        const card = div('product');
        card.innerHTML = `
          <div class="thumb"><img alt="${p.name}" src="${p.img}" style="object-fit:cover;width:100%;height:100%"></div>
          <div class="info">
            <div class="row" style="gap:8px;align-items:center"><strong>${p.name}</strong> <span class="badge">${p.category}</span></div>
            <div class="row" style="gap:8px;align-items:center">
              <span class="price">${VND(p.price)}</span>
              <small style="color:var(--muted)">‚Ä¢ ${p.material}</small>
              <small class="badge">‚òÖ ${p.rating}</small>
            </div>
            <div class="row" style="gap:6px;flex-wrap:wrap">
              ${p.sizes.map(s=>`<span class="chip">${s}</span>`).join('')}
            </div>
            <div class="actions">
              <button class="btn" onclick="addToCart('${p.id}')">Th√™m</button>
              <button class="btn ghost" onclick="openQuick('${p.id}')">Xem nhanh</button>
              <button class="btn ghost" onclick="toggleWishItem('${p.id}')">‚ù§</button>
            </div>
          </div>`;
        grid.appendChild(card);
      });
    }

    function renderCart(){
      const box = el('#cartItems'); box.innerHTML='';
      if(!state.cart.length){ box.innerHTML = '<div class="card">Gi·ªè h√†ng tr·ªëng.</div>'; }
      state.cart.forEach(item=>{
        const p = PRODUCTS.find(x=>x.id===item.id);
        const row = div('card row');
        row.style.alignItems='center';
        row.style.gap='10px';
        row.innerHTML = `
          <img src="${p.img}" alt="${p.name}" style="width:64px;height:64px;object-fit:cover;border-radius:12px">
          <div style="flex:1">
            <div class="row" style="justify-content:space-between"><strong>${p.name}</strong><span>${VND(p.price)}</span></div>
            <small style="color:var(--muted)">Size: ${item.size}</small>
          </div>
          <div class="row" style="gap:6px">
            <button class="btn ghost" onclick="chgQty('${item.id}','${item.size}',-1)">-</button>
            <div class="pill">${item.qty}</div>
            <button class="btn ghost" onclick="chgQty('${item.id}','${item.size}',1)">+</button>
            <button class="btn ghost" onclick="rmCart('${item.id}','${item.size}')">üóë</button>
          </div>`;
        box.appendChild(row);
      });
      const sub = state.cart.reduce((s,it)=>{
        const p = PRODUCTS.find(x=>x.id===it.id); return s + p.price*it.qty; },0);
      const ship = sub>=499000?0:30000;
      const disc = state.coupon==='SALE10'? Math.round(sub*0.1):0;
      const grand = sub + ship - disc;
      el('#subTotal').textContent=VND(sub);
      el('#shipping').textContent= ship? VND(ship): 'Mi·ªÖn ph√≠';
      el('#discount').textContent= disc?('-'+VND(disc)):'0ƒë';
      el('#grandTotal').textContent=VND(grand);
      el('#cartCount').textContent= state.cart.reduce((s,i)=>s+i.qty,0);
      persist();
    }

    function renderWish(){
      const box = el('#wishItems'); box.innerHTML='';
      const ids = [...state.wish];
      if(!ids.length){ box.innerHTML='<div class="card">Danh s√°ch y√™u th√≠ch tr·ªëng.</div>'; }
      ids.forEach(id=>{
        const p = PRODUCTS.find(x=>x.id===id);
        const card = div('card');
        card.innerHTML = `
          <div class="row" style="gap:10px">
            <img src="${p.img}" alt="${p.name}" style="width:72px;height:72px;object-fit:cover;border-radius:12px">
            <div style="flex:1">
              <strong>${p.name}</strong>
              <div class="row" style="justify-content:space-between"><span class="price">${VND(p.price)}</span> <button class="btn" onclick="addToCart('${p.id}')">Th√™m</button></div>
            </div>
            <button class="btn ghost" onclick="toggleWishItem('${p.id}')">üóë</button>
          </div>`;
        box.appendChild(card);
      });
      el('#wishCount').textContent = ids.length;
      persist();
    }

    function openQuick(id){
      const p = PRODUCTS.find(x=>x.id===id);
      el('#quickImg').innerHTML = `<img src="${p.img}" alt="${p.name}" style="width:100%;height:100%;object-fit:cover;border-radius:12px">`;
      el('#quickName').textContent = p.name;
      el('#quickCat').textContent = p.category;
      el('#quickPrice').textContent = VND(p.price);
      el('#quickDesc').textContent = p.desc;
      const sizes = el('#quickSizes'); sizes.innerHTML='';
      state.selectedSize = null;
      p.sizes.forEach(s=>{
        const x = div('chip', s); x.onclick=()=>{[...sizes.children].forEach(c=>c.classList.remove('badge')); x.classList.add('badge'); state.selectedSize=s;}; sizes.appendChild(x);
      });
      el('#quickAdd').onclick = ()=>{ if(!state.selectedSize){ alert('Vui l√≤ng ch·ªçn size'); return;} addToCart(p.id, state.selectedSize); toggleQuick(); };
      el('#quickWish').onclick = ()=>{ toggleWishItem(p.id); };
      toggleQuick(true);
    }

    // ====== CART OPS ======
    function addToCart(id, size=null){
      const p = PRODUCTS.find(x=>x.id===id);
      if(!size){ size = p.sizes[0]; }
      const exist = state.cart.find(i=>i.id===id && i.size===size);
      if(exist) exist.qty += 1; else state.cart.push({id, size, qty:1});
      renderCart();
      toggleCart(true);
    }
    function chgQty(id,size,delta){
      const it = state.cart.find(i=>i.id===id && i.size===size); if(!it) return;
      it.qty += delta; if(it.qty<=0) state.cart = state.cart.filter(i=>!(i.id===id && i.size===size));
      renderCart();
    }
    function rmCart(id,size){ state.cart = state.cart.filter(i=>!(i.id===id && i.size===size)); renderCart(); }
    function applyCoupon(){
      const code = el('#coupon').value.trim().toUpperCase();
      if(['SALE10'].includes(code)){ state.coupon=code; alert('√Åp d·ª•ng m√£ th√†nh c√¥ng!'); }
      else { state.coupon=null; alert('M√£ kh√¥ng h·ª£p l·ªá'); }
      renderCart();
    }

    // ====== WISHLIST ======
    function toggleWishItem(id){
      if(state.wish.has(id)) state.wish.delete(id); else state.wish.add(id);
      renderWish();
    }

    // ====== CHECKOUT ======
    function openCheckout(){
      // fill summary
      const list = el('#sumList'); list.innerHTML='';
      if(!state.cart.length){ alert('Gi·ªè h√†ng tr·ªëng'); return; }
      state.cart.forEach(it=>{
        const p = PRODUCTS.find(x=>x.id===it.id);
        const row = div('row'); row.innerHTML = `<span>${p.name} √ó ${it.qty} (size ${it.size})</span><strong>${VND(p.price*it.qty)}</strong>`; list.appendChild(row);
      });
      el('#sumCount').textContent = state.cart.reduce((s,i)=>s+i.qty,0) + ' s·∫£n ph·∫©m';
      el('#sumGrand').textContent = el('#grandTotal').textContent;
      toggleCheckout(true);
    }

    function submitOrder(e){
      e.preventDefault();
      const fd = new FormData(e.target);
      const data = Object.fromEntries(fd.entries());
      const orderId = 'FB' + Math.random().toString(36).slice(2,8).toUpperCase();
      alert('ƒê·∫∑t h√†ng th√†nh c√¥ng! M√£ ƒë∆°n: '+orderId+'\nCh√∫ng t√¥i ƒë√£ g·ª≠i x√°c nh·∫≠n ƒë·∫øn '+data.email);
      // reset
      state.cart = []; state.coupon=null; persist();
      renderCart();
      toggleCheckout(false); toggleCart(false);
    }

    // ====== UI TOGGLES ======
    function toggleCart(show){ const d=el('#cartDrawer'); d.classList[show?'add':'remove']('show'); d.setAttribute('aria-hidden', !show); }
    function toggleWish(show){ const m=el('#wishModal'); m.classList[show?'add':'remove']('show'); m.setAttribute('aria-hidden', !show); }
    function toggleQuick(show){ const m=el('#quickModal'); m.classList[show?'add':'remove']('show'); m.setAttribute('aria-hidden', !show); }
    function toggleCheckout(show){ const m=el('#checkoutModal'); m.classList[show?'add':'remove']('show'); m.setAttribute('aria-hidden', !show); }
    function scrollToProducts(){ document.getElementById('productGrid').scrollIntoView({behavior:'smooth'}); }

    // ====== EVENTS ======
    document.getElementById('openCart').onclick = ()=>toggleCart(true);
    document.getElementById('openWishlist').onclick = ()=>toggleWish(true);
    document.getElementById('priceRange').oninput = (e)=>{ state.maxPrice = +e.target.value; el('#priceVal').textContent = (+e.target.value).toLocaleString('vi-VN'); renderAll(); };
    document.getElementById('q').oninput = (e)=>{ state.q = e.target.value; renderAll(); };
    document.getElementById('sortBy').onchange = (e)=>{ state.sort = e.target.value; renderAll(); };
    document.getElementById('clearFilters').onclick = ()=>{ state={...state, cats:new Set(), sizes:new Set(), mats:new Set(), maxPrice:1000000, sort:'popular'}; renderAll(); };
    document.getElementById('subBtn').onclick = ()=>{ const email = el('#subEmail').value.trim(); if(!email){alert('Nh·∫≠p email h·ª£p l·ªá'); return;} alert('ƒêƒÉng k√Ω th√†nh c√¥ng! H√£y ki·ªÉm tra email ƒë·ªÉ x√°c nh·∫≠n.'); };
    document.getElementById('checkoutForm').addEventListener('submit', submitOrder);

    // ====== INIT ======
    function renderAll(){ renderFilters(); renderProducts(); renderCart(); renderWish(); }
    renderAll();
  </script>
</body>
</html>
